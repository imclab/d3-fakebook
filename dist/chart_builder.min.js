(function(){var t;t=function(){function t(t){var i,e;this.opts=t,this.el=t.el,this.$el=$(this.el),this.title=t.title,t.indicatorTitle&&(this.indicatorTitle=t.indicatorTitle),null!=t.data&&(this.data=t.data),e={top:80,right:100,bottom:80,left:100},this.margin=_.extend(e,this.opts.margin),delete this.opts.margin,i={height:$(window).width()<480?500:$(this.el).height(),width:$(window).width()<480?900:$(this.el).width()},this.dimensions=_.extend(i,this.opts.dimensions),delete this.opts.dimensions,this.largeScreen=1160,this.isLargeScreen=this.dimensions.width>=this.largeScreen,this.smallScreenOffset=40,!this.isLargeScreen&&this.opts.yLabelComparison&&(this.margin.bottom=this.margin.bottom+this.smallScreenOffset),this.innerWidth=this.dimensions.width-this.margin.left-this.margin.right,this.innerHeight=this.dimensions.height-this.margin.top-this.margin.bottom,this.createContainer()}return t.prototype.countryColors=["#dd5c5c","#e69545","#5cb5dd","#6272d3","#5dc960","#e645cd","#a25cdd"],t.prototype._setColorScale=function(t,i){var e,s,n;return e=_.clone(t),i&&_.isArray(i)&&(n=d3.values(i[0])),n&&(_(n).contains("World")||e.shift()),this.opts.positions&&_(this.opts.positions.length).times(function(t){return function(i){return _(t.opts.positions).contains(i)?void 0:e.splice(i,1)}}(this)),s=d3.scale.ordinal().range(e),null!=this.color?this.colorAlt=s:this.color=s},t.prototype.setTickFormat=function(t){return t.tickFormat(function(t){return function(i){return t.formatValues(i)}}(this))},t.prototype.formatValues=function(t){var i,e,s;return s=d3.round(t,5),i=d3.format(",s"),e=i(s),"-0"===e&&(e="0"),e},t.prototype.displayNotice=function(t,i){return this.$el.append('<div class="chart-notice"> <h4 class="chart-notice-title">'+t+'</h4> <p class="chart-notice-content">'+i+"</p> </div>")},t.prototype.createContainer=function(){var t,i;return t=this.dimensions.height+(this.title?40:0),i=this.dimensions.width,this.svg=d3.select(this.el).append("svg").attr("width",this.dimensions.width).attr("height",this.dimensions.height+(this.title?40:0)).attr("viewBox","0 0 "+i+" "+t).attr("perserveaspectratio","xMinYMid").append("g").attr("transform","translate("+this.margin.left+", "+this.margin.top+")")},t.prototype.buildTitle=function(){return this.title?this.title:void 0},t.prototype._getLegendVerticalOffset=function(t){var i,e;return i=this.dimensions.height,e=this.margin.top,this.opts.legendOffset?e+=this.opts.legendOffset:t?e+=20:e=e,t&&!this.isLargeScreen&&(e+=this.smallScreenOffset),i-e},t.prototype.drawLegend=function(){var t,i,e,s,n,r,o,a;return this.opts.showLegend!==!1&&(n=null!=this.opts.yLabel?this.opts.yLabel.split(",")[0]:this.opts.legendTitle,o=null!=this.opts.yLabelComparison?_.str.strLeftBack(this.opts.yLabelComparison,", "):null,s=_.str.capitalize(n),r=o,a=this._getLegendVerticalOffset(null!=r),e=r?20:0,this.svg.append("g").attr("class","legend").attr("transform","translate("+e+", "+a+")").style("font-size","12px").call(d3.legend),r)?(i=this.dimensions.width,t=this.dimensions.width-this.margin.right-this.margin.left,this.svg.selectAll(".legend-items").each(function(){var t;return t=d3.select(this),t.append("text").text(s).attr("transform","translate(-30, -20)").style("font-size","10px").style("font-weight","bold")}),this.svg.selectAll(".legend-items-comparison").each(function(){var i,s;return s=d3.select(this),s.append("text").text(r).attr("transform","translate(-30, -20)").style("font-size","10px").style("font-weight","bold"),i=parseInt($(".legend-items-comparison").outerWidth(),10),e=t-t/2+20,a=0,s.attr("transform","translate("+e+", "+a+")")})):void 0},t.prototype.drawTitle=function(){return this.svg.append("text").attr("x",(this.dimensions.width-this.margin.left-this.margin.right)/2).attr("y",0-this.margin.top/2).attr("text-anchor","middle").attr("class","chart-title").text(function(t){return function(){var i;return i=t.buildTitle(),i?i:null}}(this))},t}()}).call(this);