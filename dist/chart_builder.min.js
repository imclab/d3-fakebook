(function(){define(["d3","underscore"],function(t,i){var e;return e=function(){function e(e,s){var n,r,o;if(null==s&&(s={}),!e)throw n=new Error("Fakebook Chart requires a DOM node"),n.name="ArgumentError",n;this.opts=s,this.el=e,this.$el=t.select(this.el),this.title=s.title,s.indicatorTitle&&(this.indicatorTitle=s.indicatorTitle),null!=s.data&&(this.data=s.data),o={top:80,right:100,bottom:80,left:100},this.margin=i.extend(o,this.opts.margin),delete this.opts.margin,r={height:window.innerHeight<480?500:this.el.offsetHeight,width:window.innerWidth<480?900:this.el.offsetWidth},this.dimensions=i.extend(r,this.opts.dimensions),delete this.opts.dimensions,this.innerWidth=this.dimensions.width-this.margin.left-this.margin.right,this.innerHeight=this.dimensions.height-this.margin.top-this.margin.bottom,this.createContainer()}return e.prototype.chartColors=["#e69545","#5cb5dd","#6272d3","#5dc960","#e645cd","#a25cdd","#dd5c5c"],e.prototype._setColorScale=function(e,s){var n,r,o;return n=i.clone(e),s&&i.isArray(s)&&(o=t.values(s[0])),this.opts.positions&&i(this.opts.positions.length).times(function(t){return function(e){return i(t.opts.positions).contains(e)?void 0:n.splice(e,1)}}(this)),r=t.scale.ordinal().range(n),null!=this.color?this.colorAlt=r:this.color=r},e.prototype.setTickFormat=function(t){return t.tickFormat(function(t){return function(i){return t.formatValues(i)}}(this))},e.prototype.formatValues=function(i){var e,s,n;return n=t.round(i,5),e=t.format(",s"),s=e(n),"-0"===s&&(s="0"),s},e.prototype.createContainer=function(){var i,e;return i=this.dimensions.height+(this.title?40:0),e=this.dimensions.width,this.svg=t.select(this.el).append("svg").attr("width",this.dimensions.width).attr("height",this.dimensions.height+(this.title?40:0)).attr("viewBox","0 0 "+e+" "+i).attr("perserveaspectratio","xMinYMid").append("g").attr("transform","translate("+this.margin.left+", "+this.margin.top+")")},e.prototype.getTitle=function(){return this.title},e.prototype._getLegendVerticalOffset=function(t){var i,e;return i=this.dimensions.height,e=this.margin.top,this.opts.legendOffset?e+=this.opts.legendOffset:t?e+=20:e=e,t&&!this.isLargeScreen&&(e+=this.smallScreenOffset),i-e},e.prototype.drawLegend=function(){var e,s,n,r,o,a,h,l;return this.opts.showLegend!==!1&&(o=null!=this.opts.yLabel?this.opts.yLabel.split(",")[0]:this.opts.legendTitle,h=null!=this.opts.yLabelComparison?i.str.strLeftBack(this.opts.yLabelComparison,", "):null,r=i.str.capitalize(o),a=h,l=this._getLegendVerticalOffset(null!=a),n=a?20:0,this.svg.append("g").attr("class","legend").attr("transform","translate("+n+", "+l+")").style("font-size","12px").call(t.legend),a)?(s=this.dimensions.width,e=this.dimensions.width-this.margin.right-this.margin.left,this.svg.selectAll(".legend-items").each(function(){var i;return i=t.select(this),i.append("text").text(r).attr("transform","translate(-30, -20)").style("font-size","10px").style("font-weight","bold")}),this.svg.selectAll(".legend-items-comparison").each(function(){var i,s;return s=t.select(this),s.append("text").text(a).attr("transform","translate(-30, -20)").style("font-size","10px").style("font-weight","bold"),i=parseInt($(".legend-items-comparison").outerWidth(),10),n=e-e/2+20,l=0,s.attr("transform","translate("+n+", "+l+")")})):void 0},e.prototype.drawTitle=function(){return this.svg.append("text").attr("x",(this.dimensions.width-this.margin.left-this.margin.right)/2).attr("y",0-this.margin.top/2).attr("text-anchor","middle").attr("class","chart-title").text(function(t){return function(){var i;return i=t.getTitle(),i?i:null}}(this))},e}()})}).call(this);